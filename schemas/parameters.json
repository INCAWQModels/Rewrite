{
    "$id": "https://example.com/schemas/parameterSet",
    "$schema": "http://json-schema.org/draft/2020-12/schema#",

    "type": "object",
    "name": "Parameter set",
    "description": "A description of the structure of a parameter set",
    "properties": { 
        "parameterSetName": {"type": "string"},
        "timeStep": {
            "type": "integer", 
            "description": "the external time step in seconds on which the model runs",
            "default": 86400
        },
        "internalTimeStepMultiplier": {
            "type": "integer",
            "default": 1
        },
        "startDate": {
            "type": "string",
            "format": "date-time"
        },

        "subCatchments": {
            "type": "array",
            "properties": {
                "subCatchment": {"ref$": "/schemas/subCatchment"}
            }
        }
    },
    
    "defs":{
        "waterDepth": {         
            "title": "Data structure for water depths in a bucket",
            "$id": "https://example.com/schemas/waterDepth",
            "type": "number",
            "properties": {
                "minimum": 0.0,
                "default": 0.0
            }
        },

        "percentLandCoverage": {
            "title": "Percentage of land cover used in a land cover type or sub catchment",
            "description": "A wrapper to help ensure fractional land cover numbers are appropriately validated",
            "$id": "https://example.com/schemas/percentLandCoverage",
            "type": "number",
            "properties": {
                "minimum": 0.0,
                "maximum": 100.0,
                "default": 100.0
            }
        },
    
        "snowmeltCharacteristics": {
            "title": "Snowmelt parameters",
            "description": "land cover specific snowmelt properties",
            "$id": "https://example.com/schemas/snowmelt",
            "type": "object",
            "properties": {
                "degreeDayMeltFactor": {"type": "number"},
                "snowmeltOffset": {"type": "number"}
            }
            
        },

        "precipitationAdjustments": {
            "title": "Rain and snow adjustments",
            "description": "land cover and sub-catchment level parameters for partitioning precipitation between rain and snow",
            "$id": "https://example.com/schemas/precipitationAdjustments",
            "type": "object",
            "properties": {
                "rainfallMultiplier": {"type": "number", "default": 1.0},
                "snowfallMultiplier": {"type": "number", "default": 1.0},
                "snowThresholdTemperature": {"type": "number", "default": 0.0}
        },

        "bucket": {
            "title": "Bucket",
            "$id": "https://example.com/schemas/bucket",
            "type": "object",
            "properties": {
                "name": {"type": "string"},
                "characteristicTimeConstant": {"type": "number"},
                "evapotranspirationAdjustment": {"type": "number"},
                "relativeEvapotranspirationIndex": {"type": "number"},
                "maximumInfiltrationRate": {"type": "number"},
                "maximumDrainageRate": {"type": "number"},
                "freelyDrainingWaterDepth": {"$ref": "/schemas/WaterDepth" },
                "retainedWaterDepth": {"$ref": "/schemas/WaterDepth" },
                "tightlyBoundWaterDepth": {"$ref": "/schemas/WaterDepth"},
                "percentArea": {"$ref": "/schemas/percentLandCoverage" }
            }
        },

        "landCoverType": {
            "title": "Land cover type",
            "description": "Collection of containers for routing and processing water and chemicals in the terrestrial part of a subcatchment",
            "type": "object",
            "$id": "https://example.com/schemas/landCoverType",
            "properties": {
                "name": {"type": "string"},
                "percentArea":  {"$ref": "/schemas/percentLandCoverage" },
                "snowmelt": {"ref$": "/schemas/snowmelt"},
                "buckets": {
                    "type": "array",
                    "properties":{
                        "bucket": {"$ref": "/schemas/bucket" }
                    }
                }
            }
        },

        "streamReach": {
            "title": "Stream Reach",
            "description": "Data for a stream reach including location and flow related parameters",
            "type": "object",
            "$id": "https://example.com/schemas/streamReach",
            "properties": {
                "name": {"type": "string"},
                "length": {"type": "number"},
                "widthAtBottom": {"type": "number"},
                "a":    {"type": "number", "description": "Mannings a - channel width"},
                "b":    {"type": "number", "description": "Mannings b - channel width"},
                "c":    {"type": "number", "description": "Mannings c - channel depth"},
                "f":    {"type": "number", "description": "Mannings f - channel depth"},
                "n":    {"type": "number", "description": "Mannings roughness coefficient"}
            }
        },

        "subCatchment": {
            "title": "Sub-catchment",
            "description": "Data for a subcatchment consisting of a stream reach and one or more land cover types",
            "type": "object",
            "$id": "https://example.com/schemas/subCatchment",
            "properties": {
                "name": {"type": "string"},
                "reach": {"$ref": "/schemas/streamReach"},
                "landCoverTypes": {
                    "type": "array",
                    "properties": {
                        "landCoverType": {"$ref": "/schemas/landCoverType"}
                    }
                }
            }
        }
    }
}
}
